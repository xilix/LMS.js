<!DOCTYPE html>
<html lang="cat">
  <head>
    <title>Time prediction of EUR/USD ratio</title>
    <script src="./data/dataWrapper.js"></script>
    <script src="./data/data.js"></script>
    <script src="../modules/lms.js"></script>
    <style>
      .data-table {
        font-family: sans-serif;
      }
      .data-table th{
        border: 1px #000 solid;
        background-color: #555;
        color: #FFF;
        font-size: 12pt;
      }
      .data-table td{
        border: 1px #000 solid;
        color: #333;
        font-size: 10pt;
      }
    </style>
  </head>
  <body>
    <div id="output">
    </div>
    <script language="JavaScript">
      var i = 0, iMax = dates.length;

      // Predictor definition
      var definition = {
        "mu": {"EURUSD": {"type": "TR", "value": 0.25}},
        "inputs": {"EURUSD": 5},
        "outputs": ["EURUSD"]
      };

      // Getting predictor object from definition
      var predictor = LMS.PredictorFactory(definition);

      // Training predictor from data
      // Tarining to use the past data to predict the today currency
      // ratio
      for (i = 1; i < dates.length - 5; i += 1) {
        predictor.train(
          // Past data
          {
            "EURUSD": data[currencySymbol][dates[i - 1]],
          },
          // Today's ratio
          {"EURUSD": data[currencySymbol][dates[i]]}
        );
      }

      // Now the predictor it have been trained. Let's see how it works
      // with the data of the last 4 days:
      var realRatio, predictedRatio
        , out = document.getElementById("output"), str = out.innerHTML;

      str = "<table class=\"data-table\">" +
        "<tr><th>Date</th><th>Realratio</th>" + 
        "<th>Prdicted ratio</th><th>Error</th></tr>";
      for (i = dates.length - 5; i < dates.length; i += 1) {
        realRatio = data[currencySymbol][dates[i]];
        predictedRatio = predictor.predict()["EURUSD"];
        error = (2 * (realRatio - predictedRatio) / (parseFloat(realRatio) + parseFloat(predictedRatio)));
        
        str = str + 
        "<tr><td>" + dates[i] + "</td>" +
        "<td>" + realRatio + "</td>" +
        "<td>" + predictedRatio + "</td>" +
        "<td>" + error + "</td></tr>";
      }
      str += "</table>";

      out.innerHTML = str;
    </script>
  </body>
</html>
